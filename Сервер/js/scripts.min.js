$(document).ready(function(){$(".variants span.click").click(function(){if($(this).hasClass("nonactive")){$(this).removeClass("nonactive")}else{$(this).addClass("nonactive")}});$(".variants span.select_all").click(function(){if($(this).hasClass("nonactive")){$(this).removeClass("nonactive");$(".variants span.click").removeClass("nonactive")}else{$(this).addClass("nonactive");$(".variants span.click").addClass("nonactive")}});$(".addnewstablestoall").click(function(){shownewtable()});$(".search_block button").click(function(){var e=$("#search").val();$(".search_hidden").find("span").each(function(){if($(this).text()==e){$(this).click()}})});$(".search_block input").keypress(function(f){if(f.keyCode==13){var g=$("#search").val();$(".search_hidden").find("span").each(function(){if($(this).text()==g){$(this).click()}})}});$(".select_block_sloi span.fields").click(function(){if($(this).hasClass("nonactive")){$(".select_block span").click();$(this).removeClass("nonactive")}else{$(".select_block span").click();$(this).addClass("nonactive")}});$(".contrl_item").live("click",function(){if($(this).hasClass("active")){}else{var e=$(this).attr("pre");$(this).parent().find(".contrl_item").removeClass("active");$(this).addClass("active");$(this).parent().parent().parent().parent().parent().find(".block").removeClass("active");$(this).parent().parent().parent().parent().parent().find(".block[pre="+e+"]").addClass("active");var f=$(this).parent().parent().parent().parent().parent().parent().attr("id");$("#"+f).css("oveflow","auto !important");$("#"+f).css("height","auto !important")}});$("body").click(function(){$(".select_block").removeClass("active");$(".select_block_sloi").removeClass("active")});$(".select_block").click(function(e){e.stopPropagation()});$(".select_block_sloi").click(function(e){e.stopPropagation()});$(".see").click(function(e){e.stopPropagation();if(!$(".select_block").hasClass("active")){$(".select_block").addClass("active");$(".select_block_sloi").removeClass("active")}});$(".seesloi").click(function(e){e.stopPropagation();if(!$(".select_block_sloi").hasClass("active")){$(".select_block_sloi").addClass("active");$(".select_block").removeClass("active")}});$("button.upfile.sloibutton").click(function(){if($(this).parent().hasClass("sloi")){$("#levelid").val($(this).parent().attr("id"));$(".overlay_newfile h2").text("Загрузите файлы KML слоя")}else{$(".overlay_newfile h2").text("Загрузите файлы KML полей и дорог");$("#levelid").val("0")}$(".upload ul").html("");showopacitynewfile();var e=$(".overlay_newfile").height();$(".result_block").css("height",(e-30-27-80-0.16*e-10-22-34-20-34-27-10)+"px")});$("button.upfile.tablesbutton").click(function(){$("#levelid").val($(this).attr("idtable"));$(".upload ul").html("");showopacitynewfile();var e=$(".overlay_newfile").height();$(".result_block").css("height",(e-30-27-80-0.16*e-10-22-34-20-34-27-10)+"px")});$(".overlay_newtable .deletesign").click(function(){hideopacityisk()});$(".overlay_newfile .deletesign").click(function(){$(".newblock").css("display","none");$(".variant").removeClass("active");$(".newblock.sitselect").css("display","block");$(".newblock.namefolder input").val("");hideopacityisk();document.location.href="fields-admin.php"});$(".newtable").click(function(){var g=prompt("Введите название новой таблицы");$("#newnametable").val(g);var f=prompt("Введите кол-во столбцов в таблице");$("#newrowcount").val(f);var h="";for(var e=0;e<(f);e++){var j=prompt("Введите название колонки "+(e+1));if(h==""){h=j}else{h=h+" "+j}}$("#newrowname").val(h);$("#newtable").submit()});$(".center .del").click(function(){var e=$(this).attr("idtable");$("#delnametable").val(e);$("#deltable").submit()});$(".center .edit").click(function(){var e=$(this).attr("idtable");var f=prompt("Введите новое название таблицы");$("#nnametable").val(e);$("#nname").val(f);$("#ntable").submit()});$("button.downfile.sloibutton").click(function(){if($(this).parent().hasClass("sloi")){var e=$(this).parent().attr("id")}else{var e=0}window.open("kmldownload.php?idlevel="+e,"_blank")});$("button.downfile.tablesbutton").click(function(){var e=$(this).attr("idtable");window.open("tabledownload.php?idtable="+e,"_blank")});$(".overlay_newfile .newfile_ok").click(function(){hideopacityisk();document.location.href="fields-admin.php"});$(".overlay_newfile .newfiletable_ok").click(function(e){hideopacityisk();e.preventDefault();location.reload()});$(".overlay_newtable .newtable_ok").click(function(e){e.preventDefault();if($("#newtableglobalname").val()==""){alert("Введите название общей таблицы")}else{if($("#newtableglobalcolons").val()==""){alert("Введите кол-во колонок")}else{if($("#newtableglobalcolons").val()=="0"){alert("Должна существовать хотя бы одна колонка")}else{var h=$("#newtableglobalcolons").val();var j="";for(var f=0;f<(h);f++){var k=prompt("Введите название колонки "+(f+1));if(j==""){j=k}else{j=j+" "+k}}var g="";$(".variants .click").each(function(){if(!$(this).hasClass("nonactive")){var i=$(this).attr("attr");if(g==""){g=i}else{g=g+" "+i}}});$("#newnametableglobal").val($("#newtableglobalname").val());$("#newrowcountglobal").val($("#newtableglobalcolons").val());$("#newrownameglobal").val(j);$("#newtableglobalids").val(g);$("#newtableglobal").submit()}}}});$(".overlay_newfile .no").click(function(){hideopacityisk();document.location.href="fields-admin.php"});$(".addnewsloi").click(function(){var e=prompt("Введите название нового слоя");$("#newlayername").val(e);$("#newlayer").submit()});$(".sloi .del").click(function(){var e=$(this).parent().parent().attr("id");$("#dellayername").val(e);$("#dellayer").submit()});$(".sloi .edit").click(function(){var e=$(this).parent().parent().attr("id");var f=prompt("Введите новое название слоя");$("#edlayername").val(f);$("#edlayerid").val(e);$("#edlayer").submit()});$("td div.editrow").click(function(){var e=$(this).attr("idtable");var g=$(this).attr("row");var f=prompt("Введите новое название колонки");$("#edrowrow").val(g);$("#edrowidtable").val(e);$("#edrowname").val(f);$("#edrownameform").submit()});$("td div.delrow").click(function(){var e=$(this).attr("idtable");var f=$(this).attr("row");$("#delrowrow").val(f);$("#delrowidtable").val(e);$("#delrow").submit()});$(".newcolon").click(function(){var e=$(this).attr("idtable");var f=prompt("Введите название новой колонки");$("#newrowidtable").val(e);$("#newrowrowname").val(f);$("#newrow").submit()});var d;$("table.roads td").focus(function(){d=$(this).text()});$("table.roads td").bind("blur",function(){if($(this).text()!=d){$("#roadchangeid").val($(this).parent().find("td.id").text());$("#roadchangename").val($(this).parent().find("td.name").text());$("#roadchangecolorline").val($(this).parent().find("td.colorline").text());$("#roadchangelinewidth").val($(this).parent().find("td.colorfield").text());$("#roadchange").submit()}});$("table.roads td.delete").live("click",function(){var e=$(this).parent().find("td.id").text();$("#roaddel").val(e);$("#delroad").submit()});$("table.marks td.delete").live("click",function(){var e=$(this).parent().find("td.id").text();$("#markdel").val(e);$("#delmark").submit()});$("table.marks td.add").live("click",function(){var g=prompt("Введите название");var h=prompt("Введите широту");var f=prompt("Введите долготу");var e=prompt("Введите цвет линии");$("#markinsertname").val(g);$("#markinsertshir").val(h);$("#markinsertdol").val(f);$("#markinsertcolor").val(e);$("#markinsert").submit()});$("table.tables td.tableadd").live("click",function(){var f=$(this).parent().find("td").length-1;var h=$(this).attr("idtable");var e=[];$(this).parent().find("td").each(function(){e.push($(this).text())});var j="";for(var g=0;g<(f);g++){var k=prompt("Введите значение в колонке "+e[g]+"");if(j==""){j=k}else{j=j+" "+k}}$("#addlinerowname").val(j);$("#addlineidtable").val(h);$("#addline").submit()});var c;$("table.marks td").focus(function(){c=$(this).text()});$("table.marks td").bind("blur",function(){if($(this).text()!=c){$("#markchangeid").val($(this).parent().find("td.id").text());$("#markchangename").val($(this).parent().find("td.name").text());$("#markchangeshir").val($(this).parent().find("td.shir").text());$("#markchangedol").val($(this).parent().find("td.dol").text());$("#markchangecolorline").val($(this).parent().find("td.colorline").text());$("#markchange").submit()}});var b;$("table.fields td").focus(function(){b=$(this).text()});$(".short.table").live("click",function(){var e=$(this).parent().find(".id").text();document.location.href="table.php?id="+e});$("table.fields td").bind("blur",function(){if($(this).text()!=b){$("#fieldchangeid").val($(this).parent().find("td.id").text());$("#fieldchangename").val($(this).parent().find("td.name").text());$("#descfield").val($(this).parent().find("td.desc").text());$("#fieldchangecolorline").val($(this).parent().find("td.colorline").text());$("#fieldchangecolorfield").val($(this).parent().find("td.colorfield").text());$("#fieldchange").submit()}});$("table.fields td.delete").live("click",function(){var e=$(this).parent().find("td.id").text();$("#fielddel").val(e);$("#delfield").submit()});$("table.tables td.short.delete").click(function(){var e=$(this).attr("idthis");$("#dellineidline").val(e);$("#delline").submit()});var a;$("table.tables td").focus(function(){a=$(this).text()});$("table.tables td").bind("blur",function(){if($(this).text()!=a){$("#edlinetext").val($(this).text());$("#edlinerow").val($(this).attr("row"));$("#edlineidtable").val($(this).attr("idthis"));$("#edline").submit()}});$("#newtableglobalcolons").keydown(function(e){if(e.keyCode==46||e.keyCode==8||e.keyCode==9||e.keyCode==27||(e.keyCode==65&&e.ctrlKey===true)||(e.keyCode>=35&&e.keyCode<=39)){return}else{if((e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)){e.preventDefault()}}})});function showopacitynewfile(){short_bg_pos=$(window).scrollTop();$(".overlay").css("z-index","15000");$(".opacity_block").addClass("active");$(".overlay_newfile").addClass("active");$("#page_wrap").css("position","fixed")}function shownewtable(){short_bg_pos=$(window).scrollTop();$(".overlay").css("z-index","15000");$(".opacity_block").addClass("active");$(".overlay_newtable").addClass("active");$("#page_wrap").css("position","fixed")}function hideopacityisk(){$(window).scrollTop(short_bg_pos);$(".overlay").css("z-index","1");$(".opacity_block").removeClass("active");$(".overlay_newisk").removeClass("active");$(".overlay_newtable").removeClass("active");$("#page_wrap").css("position","relative");$(".overlay_newfile").removeClass("active");$(".upload.document .image").html("");$(".upload.document .image").removeClass("work");$(".upload.document .image").removeClass("ok");$(".upload.document .image").removeClass("error");$(".upload.lizing .image").addClass("dogovorliz");$(".upload.buysold .image").addClass("buysold");$(".upload.dogovorporuch .image").addClass("dogovorporuch");$(".upload.dover .image").addClass("dover");$(".upload.actpriem .image").addClass("actpriem");$(".upload.dopsoglliz .image").addClass("dopsoglliz");$(".upload.dosrochrast .image").addClass("dosrochrast");$(".upload.platliz .image").addClass("platliz");$(".upload.platkupla .image").addClass("platliz")};